<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>拖拽</title>
		<link rel="stylesheet" href="css/normalize.css" />
		<script src="js/jquery.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				list-style: none;
				
			}
			
			.add_link_color {
				background: rgb(251, 248, 244);
			}
			
			body {
				background: rgb(236, 236, 236);
			}
			
			.layout {
				width: 1200px;
				margin: 50px auto;
				background: #fff;
			}
			
			.layout .content_layout {
				width: 1140px;
				margin: 30px auto;
			}
			
			.layout .content_layout .class_title {
				padding: 30px 0;
			}
			
			.layout .content_layout .class_title span:first-child {
				margin: 0 5px;
			}
			
			.layout .content_layout .class_title span {
				color: #aaa;
			}
			
			.layout .content_layout .alert_box {
				margin: 20px 0 0 0;
				text-indent: 30px;
				height: 50px;
				width: 100%;
				line-height: 50px;
				border: 2px dotted #ccc;
				background: rgb(237, 249, 255);
				color: rgb(144, 144, 144);
				font-size: 14px;
			}
			
			.layout .content_layout .content_inside_layout {
				margin: 0 150px;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_title {
				color: rgb(214, 194, 174);
				padding: 50px 0;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li {
				margin-bottom: 20px;
				
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li>div {
				display: flex;
				height: 50px;
				justify-content: space-between;
				align-content: center;
			line-height: 50px;
				border: 1px solid #ddd;
				background: rgb(251, 248, 244);
				position: relative;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li i {
				margin: 0 5px;
				position: relative;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items .icon i:first-child::after {
				content: '拖动可调整位置';
				display: block;
				clear: both;
				width: 95px;
				font-size: 12px;
				line-height: 1.5em;
				text-align: center;
				border-radius: 5px;
				border: 1px solid #aaa;
				position: absolute;
				background: rgb(241, 242, 242);
				box-shadow: 0px 0px 10px #aaa;
				top: 30px;
				left: -30px;
				display: none;
				
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children {
				margin-top: 20px;
				width: 100%;
				position: relative;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li {
				padding: 0;
				height: 40px;
				margin-left: 50px;
				font-size: 14px;
				display: flex;
				justify-content: space-between;
				line-height: 40px;
				margin-bottom: 20px;
				border: 1px solid #aaa;
				position: relative;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li span {
				padding: 0 10px;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li p:nth-child(2) {
				width: 255px;
				display: flex;
				justify-content: space-between;
				align-items: center;
				border-left: 1px solid #aaa;
				position: relative;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li p:nth-child(2) span:last-child {
				margin-left: 20px;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .add_li {
				color: #aaa;
				border-color: #ccc;
				width: 790px;
				margin-left: 50px;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li .text_of {
				width: 60%;
				overflow: hidden;
				white-space: nowrap;
				text-overflow: ellipsis;
			}
			
			.layout .content_layout .content_inside_layout .content_inside_box .content_inside_items li .content_inside_items_children li p.video_link {
				justify-content: center;
			}
			
			.layout .content_layout .content_inside_layout .add_new_title {
				margin: 50px auto;
				width: 100px;
				text-align: center;
				color: #aaa
			}
			
			.layout .content_layout .content_inside_layout .control_botton {
				padding: 120px 0 150px 0
			}
			
			.layout .content_layout .content_inside_layout .control_botton a {
				display: inline-block;
				width: 130px;
				height: 40px;
				line-height: 40px;
				text-align: center;
				text-decoration: none;
				color: #fff;
			}
			
			.layout .content_layout .content_inside_layout .control_botton a:first-child {
				background: rgb(32, 108, 250);
			}
			
			.layout .content_layout .content_inside_layout .control_botton a:last-child {
				background: rgb(151, 151, 151);
			}
			
			.layout .content_layout .content_inside_layout .folding_page {
				display: inline-block;
				width: 25px;
				height: 25px;
				text-align: center;
				cursor: pointer;
			}
			
			.layout .content_layout .content_inside_layout .add_new_parent {
				width: 200px;
				height: 200px;
				cursor: pointer;
			}
		</style>
	</head>

	<body>
		<div class='layout'>
			<div class='content_layout'>
				<div class='class_title'>
					<p>班课<span>></span><span>创建录播课程</span></p>
				</div>
				<div class='alert_box'>
					<i class='iconfont'>提示</i>录播课程可以上架对外售卖，也可以共享到班级中。
				</div>
				<div class='content_inside_layout'>
					<div class='content_inside_title'>
						<h3>课程目录</h3></div>
					<div class='content_inside_box'>
						<ul class='content_inside_items'>
							<li class='content_inside_li'>
								<div class='content_inside_li_title'>
									<h3><span class='folding_page'>></span><span  class='text_of'>01 心理咨询试听</span></h3>
									<div class='icon'><i>托</i><i>删</i></div>
								</div>

								<ul class='content_inside_items_children'>
									<li class='items_children_li'>
										<p><span>01</span><span class='text_of'>心理咨询试听</span></p>
										<p><i>播</i><span class='text_of'>心理活动的生理基础</span><span>00:50:00</span></p>
									</li>
								</ul>
								<div class='add_li'>
										<p><span>+</span>新增</p>
								</div>
							</li>
							<li class='content_inside_li'>
								<div class='content_inside_li_title'>
									<h3><span class='folding_page'>></span><span class='text_of'>02 二级论文指导</span></h3>
									<div class='icon'><i>托</i><i>删</i></div>
								</div>

								<ul class='content_inside_items_children'>
									<li class='items_children_li'>
										<p><span>第一课</span><span class='text_of'>心理活动的生理基础</span></p>
										<p><i>播</i><span class='text_of'>心理活动的生理基础</span><span>00:50:00</span></p>
									</li>
									<li class='items_children_li'>
										<p><span>第二课</span><span class='text_of'>思维的概念级种类和意识与注意</span></p>
										<p><i>播</i><span class='text_of'>心理活动的生理基础</span><span>00:50:00</span></p>
									</li>
									<li class='items_children_li'>
										<p><span>第三课</span><span class='text_of'>思维的概念级种类和意识与注意</span></p>
										<p class='video_link add_link_color'>+关联视频</p>
									</li>
								</ul>
								<div class='add_li'>
										<p><span>+</span>新增</p>
								</div>
							</li>
						</ul>
					</div>
					<div class='add_new_title'>
						<p class='add_new_parent'><i>+</i>新增</p>
					</div>
					<div class='control_botton'>
						<a href="javascript():;" class='next_btn'>下一步</a>
						<a href="javascript():;" class='cancel_btn'>取消</a>
					</div>
				</div>
			</div>
		</div>
		<script src="js/strengs.js"></script>
		<!--<script>
			$.fn.kpdragsort = function(options) {
				var container = this;
				$(container).children().off("mousedown").mousedown(function(e) {
					if (e.which != 1 || $(e.target).is("input, textarea")|| window.kp_only) return; // 排除非左击和表单元素
					if (e.target.className.indexOf('add_li') == 0 || e.target.className.indexOf('text_of')==0 || e.target.className.indexOf('folding_page')==0) return;
					if (e.target.nodeName == "DIV"){
						$(e.target).parent().parent().find('.content_inside_items_children').fadeOut()
					}
					console.log(e.target.className)
					e.preventDefault(); // 阻止选中文本
					var x = e.pageX;
					var y = e.pageY;
					var _this = $(this); // 点击选中块
					var w = _this.width();
					var h = _this.height();
					var w2 = w / 2;
					var h2 = h / 2;
					var p = _this.position();
					var left = p.left;
					var top = p.top;
					window.kp_only = true;
					// 添加虚线框
					_this.before('<li id="kp_widget_holder"></li>');
					var wid = $("#kp_widget_holder");
					wid.css({
						"border": "2px dashed #ccc",
						"height": _this.outerHeight(true) - 100
					});
					
					
					// 保持原来的宽高
					_this.css({
						"width": w,
						"height": h,
						"position": "absolute",
						opacity: 0.8,
						"z-index": 999,
						"left": left,
						"top": top
					});
					// 绑定mousemove事件
					$(document).mousemove(function(e) {
				
						e.preventDefault();
						// 移动选中块
						var l = left + e.pageX - x;
						var t = top + e.pageY - y;
						_this.css({
							"left": l,
							"top": t
						});
						// 选中块的中心坐标
						var ml = l + w2;
						var mt = t + h2;
						// 遍历所有块的坐标
						$(container).children().not(_this).not(wid).each(function(i) {
							var obj = $(this);
							var p = obj.offset();
							var a1 = p.left;
							var a2 = p.left + obj.width();
							var a3 = p.top;
							var a4 = p.top + obj.height();
							console.log(obj)
							// 移动虚线框
							if (a1 < ml && ml < a2 && a3 < mt && mt < a4) {
								if (!obj.next("#kp_widget_holder").length) {
									wid.insertAfter(this);
								} else {
									wid.insertBefore(this);
								}
								return;
							}
						});
					});
					// 绑定mouseup事件
					$(document).mouseup(function() {
								if (e.target.nodeName == "DIV"){
						$(e.target).parent().parent().find('.content_inside_items_children').fadeIn()
					}
						$(document).off('mouseup').off('mousemove');
						// 检查容器为空的情况
						$(container).each(function() {
							var obj = $(this).children();
							var len = obj.length;
							if (len == 1 && obj.is(_this)) {
								$("<li></li>").appendTo(this).attr("class", "kp_widget_block").css({
									"height": 100
								});
							} else if (len == 2 && obj.is(".kp_widget_block")) {
								$(this).children(".kp_widget_block").remove();
							}
						});
						// 拖拽回位，并删除虚线框
						var p = wid.offset();
						_this.animate({
							"left": p.left,
							"top": p.top
						}, 100, function() {
							_this.removeAttr("style");
							wid.replaceWith(_this);
							window.kp_only = null;
						});
					});
				});
			}
			$(".content_inside_items_children").kpdragsort();
			$(".content_inside_items").kpdragsort();
		</script>-->
	</body>

</html>